clear; clc;
ref = input('punto a usar como referencia\n');
%load('PR.mat')
%data_ref = PR;

data_1 = importdata('Punto1.txt');
data_2 = importdata('Punto2.txt');
data_3 = importdata('Punto3.txt');
data_4 = importdata('Punto4.txt');
data_5 = importdata('Punto5.txt');
data_6 = importdata('Punto6.txt');
data_7 = importdata('Punto7.txt');
data_8 = importdata('Punto8.txt');
data_9 = importdata('Punto9.txt');
data_10 = importdata('Punto10.txt');
data_11 = importdata('Punto11.txt');
data_12= importdata('Punto12.txt');
data_13= importdata('Punto13.txt');
data_14= importdata('Punto14.txt');
data_15= importdata('Punto15.txt');
data_16= importdata('Punto16.txt');
data_17= importdata('Punto17.txt');
data_18= importdata('Punto18.txt');
data_19= importdata('Punto19.txt');
data_20= importdata('Punto20.txt');
data_21= importdata('Punto21.txt');
data_22= importdata('Punto22.txt');
data_23= importdata('Punto23.txt');
data_24= importdata('Punto24.txt');
data_25= importdata('Punto25.txt');
data_26= importdata('Punto26.txt');
data_27= importdata('Punto27.txt');
data_28= importdata('Punto35.txt');
data_29= importdata('Punto36.txt');
data_30= importdata('Punto37.txt');
data_31= importdata('Punto38.txt');
data_32= importdata('Punto39.txt');
data_33= importdata('Punto40.txt');
data_34= importdata('Punto41.txt');
data_35= importdata('Punto42.txt');
data_36= importdata('Punto43.txt');
data_37= importdata('Punto44.txt');
data_38= importdata('Punto45.txt');
data_39= importdata('Punto46.txt');
data_40= importdata('Punto47.txt');
PR = importdata('PR.txt');

mdata_1 = mean(data_1);
mdata_2 = mean(data_2);
mdata_3 = mean(data_3);
mdata_4 = mean(data_4);
mdata_5 = mean(data_5);
mdata_6 = mean(data_6);
mdata_7 = mean(data_7);
mdata_8 = mean(data_8);
mdata_9 = mean(data_9);
mdata_10 = mean(data_10);
mdata_11 = mean(data_11);
mdata_12=  mean(data_12);
mdata_13=  mean(data_13);
mdata_14=  mean(data_14);
mdata_15=  mean(data_15);
mdata_16=  mean(data_16);
mdata_17=  mean(data_17);
mdata_18=  mean(data_18);
mdata_19=  mean(data_19);
mdata_20=  mean(data_20);
mdata_21=  mean(data_21);
mdata_22=  mean(data_22);
mdata_23=  mean(data_23);
mdata_24=  mean(data_24);
mdata_25=  mean(data_25);
mdata_26=  mean(data_26);
mdata_27=  mean(data_27);
mdata_28=  mean(data_28);
mdata_29=  mean(data_29);
mdata_30=  mean(data_30);
mdata_31=  mean(data_31);
mdata_32=  mean(data_32);
mdata_33=  mean(data_33);
mdata_34=  mean(data_34);
mdata_35=  mean(data_35);
mdata_36=  mean(data_36);
mdata_37=  mean(data_37);
mdata_38=  mean(data_38);
mdata_39=  mean(data_39);
mdata_40=  mean(data_40);
%ndata = data_ref(1:27,:);
%data_15 = importdata('15 puntos.txt');
%data_30 = importdata('30 puntos.txt');
data_1=[mdata_1;
    mdata_2;
    mdata_3;
    mdata_4;
    mdata_5;
    mdata_6;
    mdata_7;
    mdata_8;
    mdata_9;
    mdata_10;
    mdata_11;
    mdata_12;
    mdata_13;
    mdata_14;
    mdata_15;
    mdata_16;
    mdata_17;
    mdata_18;
    mdata_19;
    mdata_20;
    mdata_21;
    mdata_22;
    mdata_23;
    mdata_24;
    mdata_25;
    mdata_26;
    mdata_27;
    mdata_28;
    mdata_29;
    mdata_30;
    mdata_31;
    mdata_32;
    mdata_33;
    mdata_34;
    mdata_35;
    mdata_36;
    mdata_37;
    mdata_38;
    mdata_39;
    mdata_40;];
n = 40; 
rep = repmat(data_1(ref, :), n, 1);
temp_1 = data_1 - rep;
dist_1 = sqrt(sum(abs(temp_1).^2, 2));
%temp_15 = data_15 - repmat(data_15(ref, :), n, 1);
%dist_15 = sqrt(sum(abs(temp_15).^2, 2));
%temp_30 = data_30 - repmat(data_30(ref, :), n, 1);
%dist_30 = sqrt(sum(abs(temp_30).^2, 2));
PR =PR((1:40),:);
repmat_ref = repmat(PR(ref, :), n, 1);
temp_ref = PR - repmat_ref;

dist_ref = sqrt(sum(abs(temp_ref).^2, 2));

error_abs_1 = abs(dist_1 - dist_ref);
%error_abs_15 = abs(dist_15 - dist_ref);
%error_abs_30 = abs(dist_30 - dist_ref);

%% Creating empty figures
h1 = figure(1); hold on;
title('Error estándar - Phantom - Pointer');
%h2 = figure(2); hold on;
%title('Error cuadrático - 15 puntos');
%h3 = figure(3); hold on;
%title('Error cuadrático - 30 puntos');

figure(1);
axis([0 40 -5 10]);
media_1 = mean(error_abs_1);
desviacion_1 = std(error_abs_1);
desv_media = std(media_1);
er = mean(error_abs_1)./mean(dist_ref);
plot(1:27,error_abs_1(1:27), 'r.'); 
plot(28:35,error_abs_1(28:35),'b.');
plot(36:40,error_abs_1(36:40),'g.');
hline_1 = refline(0, media_1);
hline_1.Color = 'r';

%hline_b = refline(0, 0);
%hline_b.Color = 'k';
hline_1_1u = refline(0, media_1 + desviacion_1);
hline_1_1u.Color = 'm';
hline_1_1d = refline(0, media_1 - desviacion_1);
hline_1_1d.Color = 'm';
legend({'Plano','Tercera Sección','Cuarta Sección','Media','Desviación Estándar'},'Location','northwest')

%hline_1_2u = refline(0, media_1 + 2*desviacion_1);
%hline_1_2u.Color = 'k';
%hline_1_2d = refline(0, media_1 - 2*desviacion_1);
%hline_1_2d.Color = 'k';
%figure(2);
%media_15 = mean(error_abs_15);
%desviacion_15 = std(error_abs_15);
%plot(error_abs_15, 'b.');
%hline_15 = refline(0, media_15);
%hline_15.Color = 'r';
%hline_15_1u = refline(0, media_15 + desviacion_15);
%hline_15_1u.Color = 'b';
%hline_15_1d = refline(0, media_15 - desviacion_15);
%hline_15_1d.Color = 'b';
%hline_15_2u = refline(0, media_15 + 2*desviacion_15);
%hline_15_2u.Color = 'k';
%hline_15_2d = refline(0, media_15 - 2*desviacion_15);
%hline_15_2d.Color = 'k';
%figure(3);
%media_30 = mean(error_abs_30);
%desviacion_30 = std(error_abs_30);
%plot(error_abs_30, 'k.');
%hline_30 = refline(0, media_30);
%hline_30.Color = 'r';20
%hline_30_1u = refline(0, media_30 + desviacion_30);
%hline_30_1u.Color = 'b';
%hline_30_1d = refline(0, media_30 - desviacion_30);
%hline_30_1d.Color = 'b';
%hline_30_2u = refline(0, media_30 + 2*desviacion_30);
%hline_30_2u.Color = 'k';
%hline_30_2d = refline(0, media_30 - 2*desviacion_30);
%hline_30_2d.Color = 'k';

%% Saving the results
mkdir('results')
cd('results')
saveas(h1, 'Error Estandar (40).png');
%saveas(h2, 'Error cuadrático(15).png');
%saveas(h3, 'Error cuadrático(30).png');
%}
input('Press enter to quit...')
close all;